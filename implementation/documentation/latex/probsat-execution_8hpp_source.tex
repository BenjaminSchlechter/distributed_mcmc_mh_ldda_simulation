\hypertarget{probsat-execution_8hpp_source}{}\doxysection{probsat-\/execution.hpp}
\label{probsat-execution_8hpp_source}\index{metropolis\_hastings/value\_computation/utility/probsat-\/execution.hpp@{metropolis\_hastings/value\_computation/utility/probsat-\/execution.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00001}00001 \textcolor{preprocessor}{\#ifndef PROBSAT\_EXECUTION\_HPP}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00002}00002 \textcolor{preprocessor}{\#define PROBSAT\_EXECUTION\_HPP}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00005}00005 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00006}00006 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00007}00007 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00008}00008 \textcolor{preprocessor}{\#include <cstdio>}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00009}00009 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00010}00010 \textcolor{preprocessor}{\#include <sys/select.h>}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00012}00012 \textcolor{preprocessor}{\#include "{}../../../config.hpp"{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00013}00013 \textcolor{preprocessor}{\#include "{}../../../util/util.hpp"{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00015}00015 \textcolor{preprocessor}{\#include "{}../../../util/basic\_serialization.hpp"{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00016}00016 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00017}00017 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00019}\mbox{\hyperlink{namespaceprobsat__return__cause}{00019}} \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceprobsat__return__cause}{probsat\_return\_cause}} \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00022}\mbox{\hyperlink{namespaceprobsat__return__cause_a71c44000e3464f5e6330f7d9ecf7dff6}{00022}}     \textcolor{keyword}{enum} \mbox{\hyperlink{namespaceprobsat__return__cause_a71c44000e3464f5e6330f7d9ecf7dff6}{reason}} : uint8\_t \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00023}00023         ERROR = 0,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00024}00024         TIMEOUT = 1,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00025}00025         MAX\_FLIPS= 2,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00026}00026         SUCCESS = 3,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00027}00027         NUM\_REASONS = 4}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00028}00028     \};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00031}\mbox{\hyperlink{namespaceprobsat__return__cause_a5ab4762ed5ca48b28ef6a1d98670c310}{00031}}     \textcolor{keyword}{const} \textcolor{keyword}{static} std::string \mbox{\hyperlink{namespaceprobsat__return__cause_a5ab4762ed5ca48b28ef6a1d98670c310}{as\_string}}[reason::NUM\_REASONS] = \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00032}00032         \textcolor{stringliteral}{"{}ERROR"{}},}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00033}00033         \textcolor{stringliteral}{"{}TIMEOUT"{}},}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00034}00034         \textcolor{stringliteral}{"{}MAX\_FLIPS"{}},}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00035}00035         \textcolor{stringliteral}{"{}SUCCESS"{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00036}00036     \};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00039}00039     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S>}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00040}\mbox{\hyperlink{namespaceprobsat__return__cause_a97acc51842d9d0356f182f540e380f88}{00040}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceprobsat__return__cause_a97acc51842d9d0356f182f540e380f88}{serialize}}(S \&s, \mbox{\hyperlink{namespaceprobsat__return__cause_a71c44000e3464f5e6330f7d9ecf7dff6}{reason}} \&r) \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00041}00041         uint8\_t v = r;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00042}00042         generic\_serialize(s, v);}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00043}00043         assert(v <= probsat\_return\_cause::NUM\_REASONS);}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00044}00044         r = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespaceprobsat__return__cause_a71c44000e3464f5e6330f7d9ecf7dff6}{reason}}\textcolor{keyword}{>}(v);}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00045}00045     \}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00046}00046 \};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00050}00050 uint8\_t execute\_probsat\_(}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00051}00051     uint64\_t \&num\_flips,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00052}00052     \textcolor{keyword}{const} std::string \&filename,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00053}00053     \textcolor{keyword}{const} probsat\_seed\_t seed,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00054}00054     \textcolor{keyword}{const} uint64\_t max\_flips = 0,}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00055}00055     \textcolor{keyword}{const} std::chrono::seconds \&max\_exec\_time}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00056}00056         = std::chrono::seconds::zero(),}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00057}00057     std::string *debug\_probsat\_output = \textcolor{keyword}{nullptr});}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00061}00061 std::pair<uint64\_t, probsat\_return\_cause::reason>}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00062}00062     execute\_probsat(std::string filename, probsat\_seed\_t seed);}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00066}00066 \textcolor{keyword}{template}<\textcolor{keyword}{typename} prec\_t = prec\_t>}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00067}\mbox{\hyperlink{structresult__statistics}{00067}} \textcolor{keyword}{struct }\mbox{\hyperlink{structresult__statistics}{result\_statistics}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00068}00068 \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00070}\mbox{\hyperlink{structresult__statistics_a1d167126713822eddc3e078420873714}{00070}}     std::size\_t \mbox{\hyperlink{structresult__statistics_a1d167126713822eddc3e078420873714}{probsat\_executions}} = 0;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00073}\mbox{\hyperlink{structresult__statistics_a34cb2c750d2a9023705a3501a90557b2}{00073}}     std::size\_t \mbox{\hyperlink{structresult__statistics_a34cb2c750d2a9023705a3501a90557b2}{reasons}}[probsat\_return\_cause::NUM\_REASONS] = \{0\};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00076}\mbox{\hyperlink{structresult__statistics_aea5edff5ac0ae74c6773efabf91c7c7b}{00076}}     \textcolor{keywordtype}{double} \mbox{\hyperlink{structresult__statistics_aea5edff5ac0ae74c6773efabf91c7c7b}{total\_flips\_executed}} = 0;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00080}\mbox{\hyperlink{structresult__statistics_a66cb8b2f056f7cc2c239603dde5465ba}{00080}}     prec\_t \mbox{\hyperlink{structresult__statistics_a66cb8b2f056f7cc2c239603dde5465ba}{operator()}}(}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00081}00081         std::pair<uint64\_t, probsat\_return\_cause::reason> result)}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00082}00082     \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00083}00083         prec\_t num\_flips = \textcolor{keyword}{static\_cast<}prec\_t\textcolor{keyword}{>}(result.first);}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00084}00084         \mbox{\hyperlink{structresult__statistics_a1d167126713822eddc3e078420873714}{probsat\_executions}}++;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00085}00085         assert(result.second < probsat\_return\_cause::NUM\_REASONS);}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00086}00086         \mbox{\hyperlink{structresult__statistics_a34cb2c750d2a9023705a3501a90557b2}{reasons}}[result.second]++;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00088}00088         \textcolor{keywordflow}{if} (std::numeric\_limits<uint64\_t>::max() == num\_flips) \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00089}00089             num\_flips = std::numeric\_limits<prec\_t>::quiet\_NaN();}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00090}00090         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00091}00091             \mbox{\hyperlink{structresult__statistics_aea5edff5ac0ae74c6773efabf91c7c7b}{total\_flips\_executed}} += num\_flips;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00092}00092         \}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00094}00094         \textcolor{keywordflow}{if} ((interpret\_timeout\_as\_max\_flips\_reached)}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00095}00095             \&\& (0 < probsat\_max\_flips))}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00096}00096         \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00097}00097             \textcolor{keywordflow}{if} (result.second == probsat\_return\_cause::TIMEOUT) \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00098}00098                 num\_flips = probsat\_max\_flips;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00099}00099             \}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00100}00100         \}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00102}00102         \textcolor{keywordflow}{if} (result.second != probsat\_return\_cause::SUCCESS) \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00103}00103             std::cerr << \textcolor{stringliteral}{"{}probsat executed with "{}} <<}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00104}00104                 \mbox{\hyperlink{namespaceprobsat__return__cause_a5ab4762ed5ca48b28ef6a1d98670c310}{probsat\_return\_cause::as\_string}}[result.second]}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00105}00105                 << \textcolor{stringliteral}{"{} and "{}} << num\_flips << \textcolor{stringliteral}{"{} flips"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00106}00106         \}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00108}00108         \textcolor{comment}{// return std::log(num\_flips);}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00109}00109         \textcolor{keywordflow}{return} num\_flips;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00110}00110     \};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00113}\mbox{\hyperlink{structresult__statistics_a4aed1b12f46a009fa581a61d7376cbad}{00113}}     \textcolor{keyword}{friend} std::ostream \&\mbox{\hyperlink{structresult__statistics_a4aed1b12f46a009fa581a61d7376cbad}{operator<<}}(}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00114}00114         std::ostream \&os, \textcolor{keyword}{const} \mbox{\hyperlink{structresult__statistics}{result\_statistics}} \&rs)}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00115}00115     \{}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00116}00116         \textcolor{keyword}{namespace }prc = \mbox{\hyperlink{namespaceprobsat__return__cause}{probsat\_return\_cause}};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00117}00117         \textcolor{comment}{// new version is easier parseable from the command line}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00118}00118         os << rs.\mbox{\hyperlink{structresult__statistics_a1d167126713822eddc3e078420873714}{probsat\_executions}} << \textcolor{stringliteral}{"{} executions, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00119}00119             << rs.\mbox{\hyperlink{structresult__statistics_a34cb2c750d2a9023705a3501a90557b2}{reasons}}[prc::SUCCESS] << \textcolor{stringliteral}{"{} successfull, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00120}00120             << rs.\mbox{\hyperlink{structresult__statistics_a34cb2c750d2a9023705a3501a90557b2}{reasons}}[prc::MAX\_FLIPS] << \textcolor{stringliteral}{"{} max\_flips\_reached, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00121}00121             << rs.\mbox{\hyperlink{structresult__statistics_a34cb2c750d2a9023705a3501a90557b2}{reasons}}[prc::TIMEOUT] << \textcolor{stringliteral}{"{} terminated\_by\_timeout, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00122}00122             << rs.\mbox{\hyperlink{structresult__statistics_a34cb2c750d2a9023705a3501a90557b2}{reasons}}[prc::ERROR] << \textcolor{stringliteral}{"{} with\_errors, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00123}00123             << rs.\mbox{\hyperlink{structresult__statistics_aea5edff5ac0ae74c6773efabf91c7c7b}{total\_flips\_executed}} << \textcolor{stringliteral}{"{} flips\_in\_total\_(at\_least)"{}};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00124}00124 \textcolor{comment}{/* old version}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00125}00125 \textcolor{comment}{        os << rs.probsat\_executions << "{} executions ("{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00126}00126 \textcolor{comment}{            << rs.reasons[prc::SUCCESS] << "{} successfull, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00127}00127 \textcolor{comment}{            << rs.reasons[prc::MAX\_FLIPS] << "{} max flips reached, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00128}00128 \textcolor{comment}{            << rs.reasons[prc::TIMEOUT] << "{} terminated by timeout, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00129}00129 \textcolor{comment}{            << rs.reasons[prc::ERROR] << "{} with errors, "{}}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00130}00130 \textcolor{comment}{            << "{}and at least "{} <<}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00131}00131 \textcolor{comment}{                rs.total\_flips\_executed << "{} flips in total)"{};}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00132}00132 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00133}00133         \textcolor{keywordflow}{return} os;}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00134}00134     \}}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00136}00136 \};}
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{probsat-execution_8hpp_source_l00139}00139 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
